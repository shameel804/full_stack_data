{
    "id": "learn_integtest_contracts",
    "topicId": "contracts",
    "topicTitle": "Contract Testing",
    "description": "Master Contract Testing to ensure services communicate correctly without breaking changes, focusing on Pact and Consumer-Driven Contracts",
    "baseKP": 95,
    "slides": [
        {
            "id": "contracts_1",
            "type": "content",
            "title": "What is Contract Testing?",
            "content": "# Contract Testing ü§ù\n\nA technique for testing an integration point by checking each application in isolation to ensure the messages it sends/receives conform to a shared understanding.\n\n- **Scenario**: Microservice A calls Microservice B.\n- **Problem**: If B changes its JSON response, A breaks."
        },
        {
            "id": "contracts_2",
            "type": "content",
            "title": "Why not Integration Tests?",
            "content": "# Faster than Integ ‚ö°\n\nTraditional integration tests require BOTH services to be running (Slow, brittle).\n\n- **Contract tests** use Mocks but verify the mock's schema is actually valid against the real provider later."
        },
        {
            "id": "contracts_3",
            "type": "content",
            "title": "The Consumer & Provider",
            "content": "# The Players üë•\n\n1. **Consumer**: The app that *needs* the data (e.g., Frontend, Mobile App).\n2. **Provider**: The app that *gives* the data (e.g., Backend API)."
        },
        {
            "id": "contracts_4",
            "type": "content",
            "title": "Consumer-Driven Contracts (CDC)",
            "content": "# CDC Approach üèóÔ∏è\n\nThe Consumer defines the expectations. The Provider must meet them.\n\n- **Logic**: \"I need you to give me an object with `id` and `name`.\"\n- **Benefit**: The provider knows exactly which fields are actually being used!"
        },
        {
            "id": "contracts_5",
            "quizQuestion": "In Contract Testing, who usually defines the contract in a Consumer-Driven approach?",
            "quizOptions": [
                "The Provider (Backend)",
                "The Consumer (Frontend)",
                "The Database Administrator",
                "The QA Engineer"
            ],
            "correctOptionIndex": 1,
            "type": "quiz",
            "title": "Roles Quiz",
            "content": "Defining the agreement."
        },
        {
            "id": "contracts_6",
            "type": "content",
            "title": "Pact Framework",
            "content": "# Pact üìú\n\nThe industry-standard tool for contract testing.\n\n1. Consumer writes a test using a Pact mock.\n2. Pact generates a **JSON Pact File**.\n3. The file is sent to the Provider.\n4. Provider verifies that its real responses match the file."
        },
        {
            "id": "contracts_7",
            "type": "content",
            "title": "The Pact File",
            "content": "# The Agreement üìÑ\n\nA JSON document containing:\n- Expected Request (URL, Headers, Body).\n- Expected Response (Status, Body schema).\n\n```json\n{\n  \"description\": \"A request for user 1\",\n  \"request\": { \"method\": \"GET\", \"path\": \"/user/1\" },\n  \"response\": { \"status\": 200, \"body\": { \"name\": \"John\" } }\n}\n```"
        },
        {
            "id": "contracts_8",
            "type": "content",
            "title": "Mocking vs Contracts",
            "content": "# Not Just a Mock üõë\n\n- **Standard Mock**: You *assume* the API returns X.\n- **Contract Mock**: You *verify* that the API actually returns X during the Provider build."
        },
        {
            "id": "contracts_9",
            "type": "content",
            "title": "Postel's Law",
            "content": "# The Principle üìè\n\n> \"Be conservative in what you send, be liberal in what you accept.\"\n\nContract testing enforces this by ensuring consumers only care about the fields they actually need."
        },
        {
            "id": "contracts_10",
            "quizQuestion": "What is the primary artifact generated by the Pact framework?",
            "quizOptions": [
                "A JUnit XML report",
                "A JSON Pact File",
                "A Docker Image",
                "A Swagger UI page"
            ],
            "correctOptionIndex": 1,
            "type": "quiz",
            "title": "Artifact Quiz",
            "content": "The Pact File."
        },
        {
            "id": "contracts_11",
            "type": "content",
            "title": "Pact Broker",
            "content": "# Collaboration üì¨\n\nThe **Pact Broker** is a server where consumers upload pacts and providers download them.\n\n- It tracks version compatibility (e.g., \"Consumer v1.2 is compatible with Provider v2.0\")."
        },
        {
            "id": "contracts_12",
            "type": "content",
            "title": "Verification Step",
            "content": "# Provider Verification ‚úÖ\n\nThe Provider runs a task that hits its own controllers and compares the real output with the Pact file.\n\n```bash\npact-provider-verifier --pact-url http://broker/pacts/...\n```"
        },
        {
            "id": "contracts_13",
            "type": "content",
            "title": "Breaking Changes",
            "content": "# Stopping Disasters üåã\n\nIf the backend team renames `user_name` to `username`:\n1. Provider verification fails.\n2. CI build fails.\n3. Deployment is blocked *before* the customer sees a bug!"
        },
        {
            "id": "contracts_14",
            "type": "content",
            "title": "Contract Testing vs E2E",
            "content": "# The Pyramid üîº\n\n| Feature | Contract | E2E |\n|---------|----------|-----|\n| Speed | Fast | Slow |\n| Scope | Interface | Full Flow |\n| Maintenance | Low | High |\n| Reliability | High | Flaky |"
        },
        {
            "id": "contracts_15",
            "quizQuestion": "What does a 'Pact Broker' do?",
            "quizOptions": [
                "Exchanges money for contracts",
                "Stores and shares Pact files between teams",
                "Compresses JSON files",
                "Generates random test data"
            ],
            "correctOptionIndex": 1,
            "type": "quiz",
            "title": "Infrastructure Quiz",
            "content": "The Broker."
        },
        {
            "id": "contracts_16",
            "type": "content",
            "title": "Provider States",
            "content": "# Setup State üé¨\n\nWhat if the consumer needs a contract for a \"deleted user\"?\n\n- The Provider can use **States** to prepare the database before verification (e.g., \"given user 1 has been deleted\")."
        },
        {
            "id": "contracts_17",
            "type": "content",
            "title": "Can I Deploy? (C-I-D)",
            "content": "# Deployment Gates üö¶\n\n`can-i-deploy` is a CLI tool that asks the Broker if the versions currently in the pipeline are compatible. Avoids accidental breaks on production!"
        },
        {
            "id": "contracts_18",
            "type": "content",
            "title": "Handling Multiple Consumers",
            "content": "# Many-to-One üêô\n\nOne backend might serve Web, Mobile, and Admin. A single breaking change might pass for Web but break Mobile. Contract testing catches these overlaps."
        },
        {
            "id": "contracts_19",
            "type": "content",
            "title": "Challenges",
            "content": "# Difficulties üßó\n\n- Learning curve for teams.\n- Managing the Broker infrastructure.\n- Keeping state management clean on the provider."
        },
        {
            "id": "contracts_20",
            "quizQuestion": "What is 'Can-I-Deploy' used for?",
            "quizOptions": [
                "To check if the server is online",
                "To verify version compatibility before shipping",
                "To calculate build time",
                "To install dependencies"
            ],
            "correctOptionIndex": 1,
            "type": "quiz",
            "title": "Final Quiz",
            "content": "Safe shipping."
        },
        {
            "id": "contracts_21",
            "type": "content",
            "title": "Summary",
            "content": "# Summary üéâ\n\n- ‚úÖ Prevents breaking changes in distributed systems.\n- ‚úÖ Much faster and more stable than E2E tests.\n- ‚úÖ Use **Pact** for the best tooling support.\n- ‚úÖ Deployment gates with **Pact Broker**.\n\nBridge the gap between services with Contract Testing! üöÄ"
        }
    ]
}